---
import '../styles/global.css'; // Import global styles
import { ClientRouter } from "astro:transitions";
const { currentPath } = Astro.props;
const base = import.meta.env.BASE_URL;
---

<header class="bg-blue">
  <nav class="relative grid grid-cols-3 items-center px-4 py-3">
    <!-- Logo (Left Column) -->
    <div class="flex items-center justify-start">
      <a href={base} class="flex-shrink-0">
        <img src={`${base}assets/cisney-logo.svg`} alt="Cisney Painting and Power Washing Logo" width="150" />
      </a>
    </div>

    <!-- Navigation Links (Center Column) -->
  <div class="hidden lg:flex justify-center items-center gap-6 text-base md:text-lg">
  <a
    href={base}
    class={`pb-1 transition duration-200 ease-in-out ${currentPath === '/' ? 'border-b-2 border-dark-blue' : ''}`}
    aria-current={currentPath === '/' ? 'page' : undefined}
  >
    Home
  </a>
  <a
    href={`${base}about`}
    class={`pb-1 transition duration-200 ease-in-out ${currentPath === '/about' ? 'border-b-2 border-dark-blue' : ''}`}
    aria-current={currentPath === '/about' ? 'page' : undefined}
  >
    About
  </a>
  <a
    href={`${base}services`}
    class={`pb-1 transition duration-200 ease-in-out ${currentPath === '/services' ? 'border-b-2 border-dark-blue' : ''}`}
    aria-current={currentPath === '/services' ? 'page' : undefined}
  >
    Services
  </a>
  <a
    href={`${base}projects`}
    class={`pb-1 transition duration-200 ease-in-out ${currentPath === '/projects' ? 'border-b-2 border-dark-blue' : ''}`}
    aria-current={currentPath === '/projects' ? 'page' : undefined}
  >
    Projects
  </a>
  <a
    href={`${base}contact`}
    class={`pb-1 transition duration-200 ease-in-out ${currentPath === '/contact' ? 'border-b-2 border-dark-blue' : ''}`}
    aria-current={currentPath === '/contact' ? 'page' : undefined}
  >
    Contact
  </a>
</div>


    <!-- Social Icons (Right Column for Desktop) -->
    <div class="hidden lg:flex justify-end items-center gap-3">
      <a href="https://maps.app.goo.gl/LhTCpMv5D61gKuYt7" target="_blank" rel="noopener noreferrer">
        <img src={`${base}assets/google-my-business-icon.svg`} alt="Google Business" width="30" />
      </a>
      <a href="https://www.yelp.com/biz/cisney-painting-and-power-washing-north-beach-2" target="_blank" rel="noopener noreferrer">
        <img src={`${base}assets/yelp-icon.svg`} alt="Yelp" width="20" />
      </a>
    </div>

    <!-- Hamburger Toggle (Visible on Tablet and Mobile, Right-Aligned) -->
    <button id="menu-toggle" class="lg:hidden absolute right-4 top-1/2 -translate-y-1/2 bg-orange text-dark-blue p-2 focus:outline-none border-none rounded z-10">
      <!-- Hamburger Icon -->
      <svg id="hamburger-icon" xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 block" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
          d="M4 6h16M4 12h16M4 18h16" />
      </svg>
      <!-- Close (X) Icon -->
      <svg id="close-icon" xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
          d="M6 18L18 6M6 6l12 12" />
      </svg>
    </button>
  </nav>

  <!-- Mobile Menu -->
<div id="mobile-menu" class="hidden flex-col items-center gap-4 px-4 py-6 text-base bg-blue text-white lg:hidden">    <a href={`${base}about`} class={`nav-link${Astro.url.pathname === '/about' ? ' active' : ''}`}>About</a>
    <a href={`${base}services`} class={`nav-link${Astro.url.pathname === '/services' ? ' active' : ''}`}>Services</a>
    <a href={`${base}projects`} class={`nav-link${Astro.url.pathname === '/projects' ? ' active' : ''}`}>Projects</a>
    <a href={`${base}contact`} class={`nav-link${Astro.url.pathname === '/contact' ? ' active' : ''}`}>Contact</a>
    <div class="flex gap-3 mt-2">
      <a href="https://maps.app.goo.gl/LhTCpMv5D61gKuYt7" target="_blank" rel="noopener noreferrer">
        <img src={`${base}assets/google-my-business-icon.svg`} alt="Google Business" width="30" />
      </a>
      <a href="https://www.yelp.com/biz/cisney-painting-and-power-washing-north-beach-2" target="_blank" rel="noopener noreferrer">
        <img src={`${base}assets/yelp-icon.svg`} alt="Yelp" width="20" />
      </a>
    </div>
  </div>
</header>

<script>
  const toggleHandlers = new WeakMap();

  function bindMenuToggle() {
    const toggle = document.getElementById("menu-toggle");
    const menu = document.getElementById("mobile-menu");
    const hamburger = document.getElementById("hamburger-icon");
    const close = document.getElementById("close-icon");

    if (!toggle || !menu || !hamburger || !close) return;

    menu.classList.add("hidden");
    hamburger.classList.remove("hidden");
    close.classList.add("hidden");

    // Remove old listener if it exists
    const oldHandler = toggleHandlers.get(toggle);
    if (oldHandler) {
      toggle.removeEventListener("click", oldHandler);
    }

    // Define new handler
    const handler = () => {
      menu.classList.toggle("hidden");
      menu.classList.toggle("flex");
      hamburger.classList.toggle("hidden");
      close.classList.toggle("hidden");
    };

    // Store and attach handler
    toggleHandlers.set(toggle, handler);
    toggle.addEventListener("click", handler);
  }

  document.addEventListener("astro:after-swap", bindMenuToggle);
  document.addEventListener("astro:page-load", bindMenuToggle);
</script>